# 🔄 版本更新管理

> **用途：** 管理 app 每次版本更新的新功能內容，供 WhatsNewView 使用
> **最後更新：** 2025-12-02
> **相關檔案：** `WhatsNewView.swift`、`InvestmentDashboardApp.swift`

---

## 📋 使用說明

### 如何更新 WhatsNewView 的功能列表

每次發布新版本時，請按照以下步驟更新 `WhatsNewView.swift`：

1. **編輯 features 陣列** (WhatsNewView.swift lines 79-117)
2. **更新功能項目**：修改或新增 `WhatsNewFeature` 物件
3. **選擇合適的圖示**：從 SF Symbols 中選擇合適的圖示
4. **撰寫清晰描述**：簡潔說明新功能（建議 1-2 行）
5. **添加截圖（可選）**：將 `image: nil` 改為實際圖片名稱

### 圖片管理

**添加截圖到 WhatsNewView：**

1. **準備圖片**
   - 將圖片添加到 `Assets.xcassets`
   - 建議尺寸：適合 iPhone 螢幕的比例
   - 格式：PNG 或 JPG

2. **創建 Image Set**
   - 在 Xcode 中打開 `Assets.xcassets`
   - 右鍵 → New Image Set
   - 命名（例如：`whats_new_feature_1`）
   - 拖入圖片

3. **更新 WhatsNewFeature**
   ```swift
   WhatsNewFeature(
       icon: "dollarsign.circle.fill",
       iconColor: .blue,
       title: "美股/台股批量新增",
       description: "一次為多個客戶添加相同股票，兩步驟快速完成",
       image: "whats_new_feature_1"  // 改為實際圖片名稱
   )
   ```

4. **更新 FeatureCard 顯示邏輯**
   - 如果 `image != nil`，在卡片中顯示圖片
   - 可選：圖片可以取代圖示或與圖示並存

### 版本號管理

版本號由 Xcode 的 Info.plist 管理：
- **CFBundleShortVersionString**：顯示版本號（如：1.0.6）
- **CFBundleVersion**：Build 號碼（如：8）

更新版本號：
1. 打開 Xcode
2. 選擇專案 → Target → General
3. 更新 Version 和 Build 號碼

---

## 📚 版本歷史

### v1.1 - 2025-12-02

**新功能：**

1. ✅ **左滑輸入區強化升級**
   - 圖示：`slider.horizontal.3` (藍色)
   - 描述：快速輸入各項目現值，支援多國匯率自動換算債券與結構型商品現值，簡易更新台美股股價並自動換算現值
   - 截圖：`whats_new_left_swipe`

2. ✅ **浮動按鈕批量操作**
   - 圖示：`circle.grid.3x3.fill` (綠色)
   - 描述：快速輸入多客戶 FCN 進場資訊，支援多幣別辨識，一鍵出場多筆 FCN 並提供建議試算
   - 截圖：`whats_new_floating_menu`

3. ✅ **美股/台股批量新增**
   - 圖示：`dollarsign.circle.fill` (藍色)
   - 描述：一次為多個客戶添加相同股票，兩步驟快速完成，自動計算成本和初始市值
   - 截圖：無

4. ✅ **債券批量新增**
   - 圖示：`doc.text.fill` (磚紅色 #C44536)
   - 描述：支援 11 種貨幣的債券批量添加，彈性金額輸入，自動計算報酬率
   - 截圖：無

5. ✅ **可選項目移除功能**
   - 圖示：`xmark.circle.fill` (紅色)
   - 描述：定期定額、基金、保險項目現在可以自由移除，不再擔心誤加無法刪除
   - 截圖：無

**技術改進：**
- 修復 ContentView 編譯錯誤（簡化複雜布林表達式）
- 優化批量新增流程為兩步驟
- 添加「成本不含手續費」註記

**隱私權政策更新：**
- 更新隱私權政策至 v1.1（2025-12-02）
- 新增外部 API 服務說明：
  - 匯率資料 API（多幣別匯率轉換）
  - 股價資料 API（美股/台股即時股價）
- 強調匿名請求、無個人資訊傳輸
- 同步更新中英文 MD 和 HTML 版本

**文檔更新：**
- 更新主索引（📚_主索引_README.md）
- 更新資料串流順序文檔（📊_資料串流順序.md）
- 更新隱私權政策（隱私權政策.md、Privacy_Policy.md）
- 更新 HTML 隱私權政策（privacy-zh.html、privacy-en.html）
- 創建版本更新管理文檔（🔄_版本更新管理.md）

**圖片資源：**
- 新增 `whats_new_left_swipe.imageset` (S__109486117.jpg)
- 新增 `whats_new_floating_menu.imageset` (S__109486126.jpg)

---

### v1.0.5 (Build 7) - 2025-12-02

**新功能：**

1. ✅ **美股/台股批量新增**
   - 圖示：`dollarsign.circle.fill` (藍色)
   - 描述：一次為多個客戶添加相同股票，兩步驟快速完成，自動計算成本和初始市值
   - 截圖：無

2. ✅ **債券批量新增**
   - 圖示：`doc.text.fill` (磚紅色 #C44536)
   - 描述：支援 11 種貨幣的債券批量添加，彈性金額輸入，自動計算報酬率
   - 截圖：無

3. ✅ **可選項目移除功能**
   - 圖示：`xmark.circle.fill` (紅色)
   - 描述：定期定額、基金、保險項目現在可以自由移除，不再擔心誤加無法刪除
   - 截圖：無

4. ✅ **股價即時更新**
   - 圖示：`arrow.triangle.2.circlepath.circle.fill` (綠色)
   - 描述：美股和台股支援一鍵刷新股價，自動更新損益和報酬率
   - 截圖：無

5. ✅ **結構型商品完整支援**
   - 圖示：`chart.bar.doc.horizontal.fill` (青綠色 #197278)
   - 描述：四區域整合完成：小卡、表格、左滑輸入區、浮動按鈕庫存區
   - 截圖：無

**技術改進：**
- 修復損益表格區展開當機問題
- 優化批量新增流程為兩步驟
- 添加「成本不含手續費」註記

**文檔更新：**
- 更新主索引（📚_主索引_README.md）
- 更新資料串流順序文檔（📊_資料串流順序.md）
- 創建版本更新管理文檔（🔄_版本更新管理.md）

---

## 🎨 設計指南

### 圖示顏色建議

| 功能類型 | 建議顏色 | 範例 |
|---------|---------|------|
| 金融/投資 | 藍色 `.blue` | 股票、資產 |
| 文件/報表 | 磚紅色 `Color(red: 0xC4/255, green: 0x45/255, blue: 0x36/255)` | 債券、報告 |
| 刪除/移除 | 紅色 `.red` | 移除功能 |
| 更新/刷新 | 綠色 `.green` | 同步、更新 |
| 圖表/數據 | 青綠色 `Color(red: 0x19/255, green: 0x72/255, blue: 0x78/255)` | 商品、數據 |
| 警告/提醒 | 橙色 `.orange` | 重要通知 |
| 資訊/說明 | 藍色 `.blue` | 教學、提示 |

### SF Symbols 推薦圖示

| 功能 | 圖示名稱 | 說明 |
|-----|---------|------|
| 新增 | `plus.circle.fill` | 添加功能 |
| 編輯 | `pencil.circle.fill` | 編輯功能 |
| 刪除 | `xmark.circle.fill` | 移除功能 |
| 更新 | `arrow.triangle.2.circlepath.circle.fill` | 刷新、同步 |
| 圖表 | `chart.bar.doc.horizontal.fill` | 數據、報表 |
| 金錢 | `dollarsign.circle.fill` | 財務、交易 |
| 文件 | `doc.text.fill` | 文檔、合約 |
| 搜尋 | `magnifyingglass.circle.fill` | 查找功能 |
| 設定 | `gearshape.fill` | 配置、選項 |
| 通知 | `bell.fill` | 提醒、通知 |

### 描述撰寫建議

1. **簡潔明瞭**：1-2 句話，不超過 30 字
2. **突出價值**：強調對用戶的好處
3. **使用動詞**：「支援」、「自動」、「一鍵」、「快速」
4. **量化效果**：「兩步驟」、「11 種貨幣」、「一次多個」

**範例：**
- ✅ 好：「一次為多個客戶添加相同股票，兩步驟快速完成」
- ❌ 差：「現在可以批量新增股票了」

---

## 🔧 測試指南

### 測試 WhatsNewView 顯示

1. **重置 UserDefaults**（在 WhatsNewView.swift 中使用）
   ```swift
   AppVersionManager.shared.resetWhatsNew()
   ```

2. **或使用 Xcode**
   - Product → Scheme → Edit Scheme
   - Run → Arguments
   - 添加 Launch Argument：`-resetWhatsNew YES`

3. **測試流程**
   - 重新啟動 app
   - 應該看到 WhatsNewView 自動顯示
   - 檢查所有功能卡片是否正確顯示
   - 點擊「開始使用」按鈕
   - 重新啟動 app，確認不再顯示

### 測試版本檢測

1. **修改版本號**
   - 在 Xcode 中增加 Version 號碼
   - 重新運行 app
   - 應該看到 WhatsNewView

2. **首次安裝測試**
   - 刪除 app
   - 重新安裝
   - 啟動 app
   - 應該看到 WhatsNewView

---

## 📝 更新清單範本

### 準備新版本發布時，複製以下範本：

```markdown
### vX.X.X (Build X) - YYYY-MM-DD

**新功能：**

1. ✅ **功能名稱**
   - 圖示：`icon.name` (顏色)
   - 描述：功能描述（1-2 句話）
   - 截圖：圖片名稱或「無」

2. ✅ **功能名稱**
   - 圖示：`icon.name` (顏色)
   - 描述：功能描述
   - 截圖：無

**技術改進：**
- 改進項目 1
- 改進項目 2

**錯誤修復：**
- 修復問題 1
- 修復問題 2

**文檔更新：**
- 更新的文檔列表
```

---

## ⚠️ 注意事項

1. **版本一致性**
   - WhatsNewView 中的功能必須與實際 app 功能一致
   - 不要提前宣布未完成的功能

2. **圖片大小**
   - 截圖不宜過大，建議壓縮後再添加
   - 保持圖片長寬比，避免變形

3. **更新頻率**
   - 不是每次 Build 都需要更新 WhatsNewView
   - 只在有重大功能變更時更新
   - 小修復或內部改進不需要列入

4. **本地化**
   - 目前僅支援繁體中文
   - 未來如需多語言，需要修改 WhatsNewView 架構

5. **性能考量**
   - 避免使用過大的圖片
   - 功能列表建議不超過 6 項
   - 每項描述保持簡短

---

## 🔗 相關資源

- **主索引：** 📚_主索引_README.md
- **資料流文檔：** 📊_資料串流順序.md
- **計算公式：** 📐_計算公式總覽.md
- **SF Symbols：** https://developer.apple.com/sf-symbols/
- **Apple Human Interface Guidelines：** https://developer.apple.com/design/human-interface-guidelines/

---

## 📞 聯絡資訊

如有問題或建議，請參考主索引的維護指南。
